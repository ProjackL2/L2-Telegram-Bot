# Локализация

В этом разделе объясняется, как изменить сообщения, видимые пользователям, и добавить переводы.

### Где хранятся сообщения

- Тексты сообщений и кнопок Hub хранятся в виде Markdown-файлов в папке `config/localization/messages/`.
- Сообщения: `msg_start.md`, `msg_menu.md`, `msg_error.md`.
- Метки меню: `menu_settings.md`, `menu_admin.md` и т. д.
- Файлы загружаются Hub во время выполнения и отображаются как сообщения в Telegram.
- Вы можете отключить кэширование переводов, установив `translation.cache=false` в `config/hub.properties`.

#### Редактирование существующих текстов

1) Если кэширование переводов включено, остановите Hub (рекомендуется для избежания частичных перезагрузок).

2) Откройте файл, который хотите изменить, в `config/localization/messages/`.

3) Отредактируйте содержимое Markdown.

4) Запустите Hub, если он был остановлен, и проверьте результат в Telegram.


### События и форматы классов (XML)

В то время как общие сообщения хранятся в Markdown-файлах, специфические данные, такие как уведомления о событиях и названия классов персонажей, управляются в XML-файлах, расположенных непосредственно в `config/localization/`:

- `events.xml`: Определяет, как игровые события (входы, смерти, убийства и т. д.) форматируются в Telegram.
- `classes.xml`: Содержит переводы для классов персонажей Lineage II.

#### Изменение переводов в XML
1. Откройте нужный XML-файл (`events.xml` or `classes.xml`).
2. Найдите тег `<tr name="...">` для записи, которую хотите отредактировать.
3. Измените атрибуты внутри тега конкретного языка (например, `<en ... />` для английского или `<ru ... />` для русского).
   - **name**: Краткое имя, используемое в меню или заголовках.
   - **message**: Текст, отправляемый в Telegram (поддерживает Markdown).
   - **description**: Внутреннее описание события.

Основные моменты

- Поддержка Markdown: Используйте `*жирный*`, `_курсив_` и другие поддерживаемые Telegram элементы Markdown в атрибуте `message`.
- Плейсхолдеры: Оставляйте плейсхолдеры вида `%playerName%` или `%serverName%` без изменений. Они динамически заменяются Hub.
- Структура XML: Не меняйте атрибут `name` тега `<tr ...>`, так как он используется Hub для идентификации события или класса.

### Языки и значения по умолчанию

- Язык по умолчанию определяется параметром `translation.default.lang` в `config/hub.properties` (например, `en`).
- Простейшая настройка — это один набор файлов сообщений (перечисленных выше), который выступает в качестве языка по умолчанию.
- Подход с шаблонами для нескольких языков:
  - Создайте параллельный набор файлов сообщений для каждого языка, зеркально отражая ключи.
  - Пример структуры (вы можете адаптировать её под свои нужды):
    - `config/localization/messages/` — по умолчанию (английский)
    - `config/localization/messages/ru/` — русский
    - `config/localization/messages/es/` — испанский
  - Затем установите `translation.default.lang=<ваш_язык>`, если хотите сменить язык по умолчанию.
  - Если код запрашивает конкретный язык (`lang`) для пользователя, он будет загружен из соответствующей папки (с откатом к языку по умолчанию, если файл отсутствует).

### Связанные внутриигровые HTML (на стороне Agent)

- Некоторые шаблоны внутриигрового контента находятся в `data/html/en/mods/tgbot/` и копируются в пакеты игрового сервера.
- Вы можете локализовать или настроить эти HTML-файлы аналогичным образом и заново развернуть пакет Agent там, где это необходимо.
