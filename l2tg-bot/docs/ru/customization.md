# Кастомизация

Этот раздел описывает надежные способы адаптации бота и агента под ваш сервер с использованием шаблонов.

## Настройка меню и команд (Hub)

- Тексты меню и справочные сообщения находятся в `config/localization/messages/` (см. раздел «Локализация»).
- Для более глубоких изменений поведения изучите код Hub в папке `java/l2tg/hub/`:
    - Уровень бота: `java/l2tg/hub/bot/` и `java/l2tg/hub/bot/command/**`
    - Сервисы: `java/l2tg/hub/service/**`
- Типичные изменения:
    - Добавление или скрытие пунктов меню для администраторов/игроков.
    - Изменение формата статистики сервера перед отправкой в Telegram.
- После изменения кода:
    - Пересоберите Hub: `gradlew.bat obfuscateHub` (или `distHub` для получения готовой папки).
    - Замените `l2tg-hub-1.0.jar` на вашем сервере и перезапустите его.

## Настройка скрипта интеграции Agent

- Agent интегрируется с вашим игровым сервером через `AgentScript.java`, расположенный для каждой цели:
    - `target/asgard/script/services/AgentScript.java`
    - `target/kain/script/services/AgentScript.java`
    - `target/eternity-hf/script/services/AgentScript.java`
- Эти файлы копируются в дистрибутив как `game/data/scripts/services/AgentScript.java`.
- Что можно изменить:
    - Какие внутриигровые события отслеживать и отправлять в Hub (убийства, уровни, входы и т. д.).
    - Как разрешаются имена/ID игроков.
    - Ограничение или фильтрация часто повторяющихся событий.
- Перезагрузите скрипты в соответствии с документацией вашей серверной сборки или перезагрузите сервер.

## Настройка внутриигрового HTML (Agent)

- Шаблоны HTML находятся в `data/html/en/mods/tgbot/` и упаковываются в каждый дистрибутив Agent в `game/data/html/...`.
- Вы можете редактировать их в соответствии с брендингом и языком вашего сервера.
- После редактирования пересоберите и заново разверните пакет Agent.

## Логирование и диагностика

- Настройте `config/log.properties` для повышения детализации во время тестирования.
- Следите за логами Hub на предмет сообщений о регистрации RMI при подключении Agent.
- Если сообщения задерживаются, проверьте параметры `tg.global.rate_limit`, `event.sender.pool_size` и задержку сети.
